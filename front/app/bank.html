<!DOCTYPE html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
    localStorage.setItem("page", "bank");
    $(function () {
        $("#header").load("inc/header.html");
        $("#top").load("inc/top.html");
        $("#left").load("inc/left_nav.html");
    });
    var api = localStorage.getItem("api");
    var userId = localStorage.getItem("userId");



</script>
<link rel="stylesheet" href="js/datatables/datatables.css" type="text/css"/>
<div id="header"></div>

</head>
<body class="">
  <section class="vbox">
    <div id="top"></div>
    <section>
      <section class="hbox stretch">
        <!-- .aside -->
        <aside class="bg-black aside-md hidden-print" id="nav">
          <div id="left"></div>
        </aside>
        <!-- /.aside -->
        <section id="content">
          <section class="vbox">
            <section class="scrollable padder">
              <div class="m-b-md">
                <div style="float: right;"><a href="addnewbankacc.html" class="btn btn-s-md btn-primary">Add New Bank Account</a></div>
                <a href="addnewbankacc.html"></a>
                <h3 class="m-b-none">Banks</h3>
                <small><a href="index.html">Home</a> / <span class="m-t-xs text-success">Banks</span> </small>
              </div>
              <section class="panel panel-default">
                <header class="panel-heading">
                  <h4><div class="">All Bank Accounts</div></h4>
                </header>
                <div class="table-responsive">

                  <table class="table table-striped m-b-none" data-ride="datatables" id="categoryTable">
                    <thead>
                    <tr>
                      <th>ID</th>
                      <th>Title</th>
                      <th>Type</th>
                      <th>Account Number</th>
                      <th>Total Amount</th>
                    </tr>
                    </thead>
                    <tbody role="alert" aria-live="polite" aria-relevant="all" id="tbody">

                    </tbody>
                  </table>
                </div>
                <script>
                    $.get(api+"getBank/"+userId, function (data) {

                        var myBooks = data;
                        

                        var col = [];
                        for (var i = 0; i < myBooks.length; i++) {
                            for (var key in myBooks[i]) {
                                if (col.indexOf(key) === -1) {
                                    col.push(key);
                                }
                            }
                        }

                        var table = document.getElementById("tbody");
                        for (var i = 0; i < myBooks.length; i++) {
                            tr = table.insertRow(-1);
                            for (var j = 0; j < col.length; j++) {
                                var tabCell = tr.insertCell(-1);
                                tabCell.innerHTML = myBooks[i][col[j]];

                            }
                            var id=myBooks[i]['id'];

                            tabCell.innerHTML += '<button onclick="deleteBank('+id+')" class="actionstyle btn btn-danger">Delete</button><button onclick="editBank('+id+')" class="actionstyle btn btn-primary">Edit</a>';
                        }

                        $('[data-ride="datatables"]').each(function () {
                            var categoryTable = document.getElementById("categoryTable");
                            var oTable = $(categoryTable).dataTable({
                                "bProcessing": true,
                                "sDom": "<'row'<'col-sm-6'l><'col-sm-6'f>r>t<'row'<'col-sm-6'i><'col-sm-6'p>>",
                                "sPaginationType": "full_numbers",
                                "aoColumns": [
                                    {"mData": "id"},
                                    {"mData": "title"},
                                    {"mData": "type"},
                                    {"mData": "acc_no"},
                                    {"mData": "acc_total"}
                                ]
                            });
                        });
                    });

                    function editBank(id){
                        $.get(api+"editBank/"+id, function (data) {
                            window.location.replace("editBank.html?id="+data['id']);
                        });
                    }
                    function deleteBank(id){
                        $.post(api+"deleteBank/"+id, function () {
                            window.location.replace("bank.html");
                        });
                    }
                </script>
              </section>
            </section>
          </section>
        </section>
      </section>
    </section>
  </section>
  <script src="js/jquery.min.js"></script>
  <!-- Bootstrap -->
  <script src="js/bootstrap.js"></script>
  <!-- App -->
  <script src="js/app.js"></script>
  <script src="js/slimscroll/jquery.slimscroll.min.js"></script>
  <!-- datatables -->
<script src="js/datatables/jquery.dataTables.min.js"></script>
<script src="js/datatables/jquery.csv-0.71.min.js"></script>
<!--<script src="js/datatables/demo.js"></script>-->
  <script src="js/app.plugin.js"></script>
</body>
</html>
